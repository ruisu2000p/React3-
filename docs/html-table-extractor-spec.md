# HTML Table Extractor 仕様書

## 1. 概要

### 1.1 目的
HTML Table Extractorは、HTMLコンテンツからテーブルデータを抽出し、CSV、JSON、Excelなどの形式でエクスポートできるウェブアプリケーションです。さらに、抽出したテーブルデータの編集、操作、分析機能も提供します。

### 1.2 対象ユーザー
- ウェブページからデータを収集する必要があるデータアナリスト
- HTMLから構造化データを抽出したいウェブ開発者
- テーブル形式のデータを処理する必要があるビジネスユーザー

### 1.3 主な機能
- HTMLからテーブルを抽出
- テーブルデータの可視化
- データの編集と操作
- 複数の形式でのエクスポート
- データの整理とクリーニング

## 2. 機能仕様

### 2.1 入力方法
アプリケーションは以下の3つの入力方法をサポートします：

1. **HTML直接入力**
   - テキストエリアにHTMLコードを直接貼り付け
   - 入力制限: 最大10MB

2. **ファイルアップロード**
   - サポートするファイル形式: .html, .htm, .xhtml, .xml
   - ファイルサイズ制限: 15MB
   - ブラウザのドラッグ＆ドロップ機能をサポート

3. **URLからのフェッチ**
   - 指定されたURLからHTMLコンテンツを取得
   - CORSプロキシオプション（クロスオリジンリクエスト用）
   - カスタムプロキシURLの設定が可能

### 2.2 テーブル抽出
- DOMParser APIを使用してHTMLを解析
- すべての`<table>`要素を検出して処理
- 抽出処理の性能最適化（大きなドキュメントでも効率的に動作）
- 抽出の進捗状況をリアルタイム表示

#### 2.2.1 抽出オプション
- 自動ヘッダー検出
- 空白の削除
- 空の行を無視
- 特殊文字の変換
- コンテキストに応じたヘッダーの識別（ヒューリスティックアルゴリズム）

### 2.3 テーブル表示と操作

#### 2.3.1 テーブルナビゲーション
- 複数テーブルのタブ切り替え
- テーブルの概要統計表示（行数、列数、空セルの割合など）
- ページネーション機能
- 行数表示の制御（5, 10, 25, 50, 100行）

#### 2.3.2 検索と並べ替え
- テーブル内のすべてのデータをカバーする全文検索
- 列ごとのソート（昇順・降順）
- 検索結果のハイライト

#### 2.3.3 データ編集機能
- セル内容の直接編集
- 行・列の追加削除
- ヘッダー名の変更
- 行・列の選択（一括操作用）
- 編集モードの切り替え

#### 2.3.4 テーブル操作ツール
- 行と列の追加
- テーブルの転置（行列入替）
- 空行の削除
- テーブルの結合
- データクリーニング
- 行・列の選択と削除
- テーブルの分割

### 2.4 エクスポート機能

#### 2.4.1 サポートするエクスポート形式
- CSV形式（カンマ区切り値）
- JSON形式（構造化データ）
- Excel形式（.xlsx）
- テキスト形式（タブ区切り）

#### 2.4.2 エクスポートオプション
- 単一テーブルのエクスポート
- すべてのテーブルを一括エクスポート
- クリップボードへのコピー
- カスタムファイル名の設定

## 3. ユーザーインターフェース仕様

### 3.1 レイアウト
- レスポンシブデザイン（モバイル・タブレット・デスクトップに対応）
- モダンなカードベースのUI
- 明確なセクション分け
- アクセシビリティ対応

### 3.2 主要UI要素
- 入力方法タブ
- テーブル抽出ボタン
- テーブルナビゲーションバー
- テーブル表示領域
- 操作ツールパネル
- エクスポートボタン
- ステータス表示領域
- ページネーションコントロール

### 3.3 インタラクション
- ドラッグ＆ドロップでのファイルアップロード
- ボタンやスイッチのホバーエフェクト
- アニメーション付き進捗表示
- 成功・エラーメッセージの表示
- 編集モードでのセルクリックでの編集開始
- 行・列の選択インターフェース
- ドロップダウンメニューでの操作選択

### 3.4 フィードバック
- 処理ステータスの可視化
- エラーメッセージを明確に表示
- 成功メッセージをトースト通知で表示
- 処理統計の表示
- 処理時間の表示

## 4. 技術仕様

### 4.1 開発環境
- React.js 18.x
- JavaScript (ES6+)
- CSS3 with Tailwind CSS
- HTML5
- Node.js 16.x以上（開発環境用）

### 4.2 依存ライブラリ
- **React**: UIコンポーネントライブラリ
- **Papaparse**: CSV解析と生成
- **XLSX**: Excelファイル処理
- **File-Saver**: ファイルダウンロード
- **Lodash**: ユーティリティ関数

### 4.3 技術的要件
- モダンブラウザ対応（Chrome, Firefox, Safari, Edge最新版）
- JavaScriptが有効であること
- 最小ハードウェア要件: 2GB RAM, 1GHz CPU
- インターネット接続（URL取得機能使用時のみ）

### 4.4 パフォーマンス要件
- 5MB以下のHTMLで1秒以内にテーブル抽出完了
- 最大1000行×100列のテーブルを処理可能
- 一度に最大50のテーブルを処理可能
- レスポンシブUI: 操作レスポンス時間300ms以下

## 5. 実装詳細

### 5.1 主要コンポーネント
- **HTMLTableExtractor**: メインコンポーネント
- **テーブル抽出エンジン**: HTMLの解析と処理
- **テーブル表示コンポーネント**: データの表示
- **テーブル編集インターフェース**: データ操作
- **エクスポートモジュール**: 各形式へのエクスポート

### 5.2 データフロー
1. ユーザーがHTMLを入力/アップロード/URL指定
2. HTMLをDOMParserで解析
3. テーブル要素を検出
4. テーブルデータを構造化
5. ユーザーインターフェースに表示
6. ユーザーによる編集・操作
7. 指定形式でエクスポート

### 5.3 エラーハンドリング
- 無効なHTMLの検出と通知
- ファイル読み込みエラーの管理
- CORS制限の通知と対応策
- 大きすぎるファイルの検出
- テーブルが存在しない場合の通知

### 5.4 セキュリティ考慮事項
- クライアントサイドのみで処理（サーバーにデータ送信なし）
- 入力値の適切なサニタイズ
- URL取得時のCORS対策

## 6. ユーザーガイド

### 6.1 インストール手順
1. プロジェクトをクローンまたはダウンロード
2. 必要な依存関係をインストール（`npm install`）
3. 開発サーバーを起動（`npm start`）
4. ブラウザでアプリケーションにアクセス（通常 http://localhost:3000）

### 6.2 基本的な使用方法
1. 入力方法を選択（HTML貼り付け、ファイルアップロード、URL）
2. HTMLを提供
3. 「テーブル抽出」ボタンをクリック
4. 抽出されたテーブルを表示、編集
5. 必要な形式でエクスポート

### 6.3 高度な機能
- テーブル編集モードの使用
- 行や列の操作
- テーブルの転置や結合
- データのクリーニング
- 複雑なHTMLからの選択的抽出

## 7. 将来の拡張計画

### 7.1 予定されている機能
- 高度なフィルタリング（条件付きフィルター）
- カスタムデータ変換ルール
- データ可視化ツール（グラフ、チャート）
- テンプレート保存機能

### 7.2 長期的な改良
- オフライン機能サポート
- 多言語サポート
- APIによるプログラム的アクセス
- バッチ処理機能

## 8. 変更履歴

### バージョン 1.0.0（初期リリース）
- 基本的なHTML抽出機能
- テーブル表示とCSVエクスポート

### バージョン 1.1.0
- JSON, Excelエクスポート追加
- テーブル検索機能追加

### バージョン 2.0.0（現行）
- テーブル編集機能追加
- テーブル操作ツール追加
- データクリーニング機能追加
- UI改善とパフォーマンス最適化
